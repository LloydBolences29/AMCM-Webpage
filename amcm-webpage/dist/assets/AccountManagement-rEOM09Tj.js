import{r as o,j as e}from"./index-1y3UAu6N.js";import{T as K}from"./Table-DoVKgZN2.js";import{a as Q,M as c}from"./Footer-DEjXnE2X.js";import{B as h}from"./Button-DuTH_Hsw.js";import{S as L,A}from"./Alert-6LqMrRQy.js";import{F as r}from"./Form-CVo1IMGl.js";import{R as p}from"./Row-DkFBgvvI.js";import{C as i}from"./Col-CLIeRPa0.js";import"./Button-D8NJ8Bso.js";import"./ButtonBase-B-Rnfy97.js";import"./DefaultPropsProvider-D4Td3UxR.js";import"./extends-CF3RwP-h.js";import"./createSimplePaletteValueFilter-Mcy8FDC4.js";import"./useSlot-DG_Pp0Lk.js";import"./getReactElementRef-CU6zTt4J.js";import"./ownerDocument-DW-IO8s5.js";import"./Paper-25ehZ_rl.js";import"./createSvgIcon-DR9AEGWY.js";import"./CircularProgress-CmbX6jye.js";const je=()=>{const E={firstname:"",lastname:"",username:"",email:"",password:"",role:""},[D,P]=o.useState([]),[B,f]=o.useState(!1),[n,x]=o.useState(E),[G,m]=o.useState("idle"),[R,v]=o.useState(!1),[T,j]=o.useState(!1),[k,d]=o.useState(""),[N,g]=o.useState(!1),[a,u]=o.useState({id:"",firstname:"",lastname:"",username:"",email:"",role:""}),[b,M]=o.useState(null),[I,C]=o.useState(!1),[F,O]=o.useState(null),y="/api",H=()=>{f(!0)},_=()=>{f(!1)},$=s=>{M(s),C(!0)},z=async s=>{s.preventDefault();try{const t=await fetch(`${y}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"}),l=await t.json();t.ok?(S(),x(E),m("success"),v(!0),d(l.message),f(!1)):(m("error"),d(l.message),j(!0))}catch(t){console.log("Error Adding User.",t),m("error"),j(!0),d(t.message)}},V=async s=>{s.preventDefault();const t={};if(Object.keys(a).forEach(l=>{a[l]!==F[l]&&(t[l]=a[l])}),t.id=a.id,Object.keys(t).length<=1){console.log("No changes detected.");return}try{const l=await fetch(`${y}/user/edit-user`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"}),U=await l.json();console.log("Data: ",U),l.ok?(S(),m("success"),v(!0),d(U.message),g(!1)):(m("error"),j(!0),d(U.message))}catch(l){console.log("Error Saving User.",l),m("error"),j(!0),d(l.message)}},J=async()=>{const s=b.id;if(!s){console.error("No user selected for deletion."),d("Error: No user selected."),j(!0);return}try{const t=await fetch(`${y}/auth/delete-user/${s}`,{method:"DELETE",credentials:"include"}),l=await t.json();t.ok&&(m("success"),v(!0),d(l.message),C(!1),S())}catch(t){console.log("Error Deleting User.",t),m("error"),j(!0),d(t.message)}},q=s=>{u(s),O(s),g(!0)},S=async()=>{try{const s=await fetch(`${y}/user/get-users`);if(!s.ok)throw new Error("Failed to fetch users");const t=await s.json();P(t)}catch(s){console.error("Error fetching all users:",s)}};o.useEffect(()=>{S()},[]);const w=(s,t)=>{t!=="clickaway"&&(v(!1),j(!1))};return console.log("Users to be deleted: ",b?.id),e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"add-user-container",children:e.jsx("div",{id:"add-user-wrapper",children:e.jsx("div",{id:"add-user-button",children:e.jsx(h,{variant:"outline-primary",onClick:H,children:"Add User"})})})}),G==="success"?e.jsx(L,{open:R,autoHideDuration:5e3,onClose:w,children:e.jsx(A,{onClose:w,severity:"success",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:k})}):e.jsx(L,{open:T,autoHideDuration:5e3,onClose:w,children:e.jsx(A,{onClose:w,severity:"error",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:k})}),e.jsxs(K,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"light",className:"my-4 shadow-sm rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:D.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.username}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.role}),e.jsx("td",{children:e.jsxs("div",{children:[e.jsx(h,{variant:"outline-primary",size:"sm",className:"me-2",onClick:()=>q(s),children:"Edit"}),e.jsx(h,{variant:"outline-danger",size:"sm",className:"me-2",onClick:()=>$(s),children:e.jsx(Q,{})})]})})]},s.id))})]}),B&&e.jsxs(c,{show:B,onHide:()=>f(!1),children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Add a User"})}),e.jsx(c.Body,{children:e.jsxs(r,{onSubmit:z,children:[e.jsxs(p,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"First name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter firstname",value:n.firstname,onChange:s=>{x({...n,firstname:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Last name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter lastname",value:n.lastname,onChange:s=>{x({...n,lastname:s.target.value})}})]})})]}),e.jsxs(p,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"Username"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter a username",value:n.username,onChange:s=>{x({...n,username:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Role"}),e.jsxs(r.Control,{as:"select",value:n.role,onChange:s=>x({...n,role:s.target.value}),children:[e.jsx("option",{value:"",children:"Select a Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]})})]}),e.jsxs(p,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicEmail",children:[e.jsx(r.Label,{children:"Email:"}),e.jsx(r.Control,{type:"email",name:"email",placeholder:"Please enter your email",value:n.email,onChange:s=>{x({...n,email:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicPassword",children:[e.jsx(r.Label,{children:"Password:"}),e.jsx(r.Control,{type:"password",placeholder:"Please enter your password",value:n.password,onChange:s=>{x({...n,password:s.target.value})}})]})})]}),e.jsx(h,{className:"mx-1",variant:"secondary",onClick:_,children:"Close"}),e.jsx(h,{className:"mx-1",variant:"primary",type:"submit",children:"Save Changes"})]})})]}),I&&e.jsxs(c,{show:I,onHide:()=>C(!1),children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Delete User"})}),e.jsxs(c.Body,{children:[e.jsxs("p",{children:["Are you sure you want to delete user ",b?.username,"?"]}),e.jsx(h,{className:"mx-1",variant:"secondary",onClick:()=>C(!1),children:"Cancel"}),e.jsx(h,{className:"mx-1",variant:"danger",onClick:J,children:"Delete"})]})]}),N&&e.jsxs(c,{show:N,onHide:()=>g(!1),children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Edit User"})}),e.jsx(c.Body,{children:e.jsxs(r,{onSubmit:V,children:[e.jsxs(p,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"First name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter firstname",value:a?a.firstname:"",onChange:s=>{u({...a,firstname:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Last name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter last name",value:a?a.lastname:"",onChange:s=>{u({...a,lastname:s.target.value})}})]})})]}),e.jsxs(p,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"Username"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter a username",value:a?a.username:"",onChange:s=>{u({...a,username:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Role"}),e.jsxs(r.Control,{as:"select",value:a?a.role:"",onChange:s=>u({...a,role:s.target.value}),children:[e.jsx("option",{value:"",children:"Select a Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]})})]}),e.jsx(p,{className:"mb-3",children:e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicEmail",children:[e.jsx(r.Label,{children:"Email:"}),e.jsx(r.Control,{type:"email",name:"email",placeholder:"Please enter your email",value:a?a.email:"",onChange:s=>{u({...a,email:s.target.value})}})]})})}),e.jsxs(p,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicIsActive",children:[e.jsx(r.Label,{children:"Active Status:"}),e.jsxs(r.Control,{as:"select",value:a&&a.is_active!==void 0?a.is_active:"",onChange:s=>{u({...a,is_active:s.target.value})},children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),e.jsx(i,{children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Lock Status:"}),e.jsx(r.Check,{type:"switch",id:"custom-switch",checked:a?a.is_locked:!1,onChange:s=>{u({...a,is_locked:s.target.checked})}})]})})]}),e.jsx(h,{className:"mx-1",variant:"secondary",onClick:()=>g(!1),children:"Close"}),e.jsx(h,{className:"mx-1",variant:"primary",type:"submit",children:"Save Changes"})]})})]})]})};export{je as default};
