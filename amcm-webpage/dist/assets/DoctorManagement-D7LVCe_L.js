import{r,j as e}from"./index-C3TqbOx3.js";import{e as ue}from"./Footer-jYdelOlm.js";import{T as pe,P as v}from"./TextField-CkIx-BQF.js";import{B as c}from"./Button-BPfweHTx.js";import{S as V,A as q}from"./Alert-P8xlhBoF.js";import{T as xe}from"./Table-CZP6b0Rt.js";import{c as k,D as I,a as L,b as R,T as je}from"./Tooltip-D6PmvPUg.js";import{g as ge,a as fe,u as Ce,s as ye,c as De,b as Se,r as ve}from"./DefaultPropsProvider-BkAkqsQB.js";import{T as be}from"./Typography-TJkOpU_H.js";import{F as n}from"./Form-Damoyd4z.js";import{R as p}from"./Row-BqlkP4py.js";import{C as l}from"./Col-BA0xTIPd.js";import"./Anchor-Cb53gYmp.js";import"./Button-O3kS6TXu.js";import"./useSlot-DBlvMu_V.js";import"./ButtonBase-CfVmB-kl.js";import"./extends-CF3RwP-h.js";import"./createSimplePaletteValueFilter-BFiyISdh.js";import"./CircularProgress-BK_KCUok.js";import"./Select-k_YXMWfY.js";import"./Modal-D3yHNxEr.js";import"./ownerWindow-D4Hi_mU5.js";import"./ownerDocument-DW-IO8s5.js";import"./getReactElementRef-_Lufzkz4.js";import"./Fade-ECBsJ49F.js";import"./useSlotProps-BBV0xhFl.js";import"./Paper-DADNEqzy.js";import"./debounce-Be36O1Ab.js";import"./createSvgIcon-Cykufoml.js";import"./index-6uHMXlRM.js";function Te(i){return ge("MuiDialogContentText",i)}fe("MuiDialogContentText",["root"]);const we=i=>{const{classes:d}=i,a=Se({root:["root"]},Te,d);return{...d,...a}},Ne=ye(be,{shouldForwardProp:i=>ve(i)||i==="classes",name:"MuiDialogContentText",slot:"Root"})({}),M=r.forwardRef(function(d,x){const a=Ce({props:d,name:"MuiDialogContentText"}),{children:$,className:j,...y}=a,g=we(y);return e.jsx(Ne,{component:"p",variant:"body1",color:"textSecondary",ref:x,ownerState:y,className:De(g.root,j),...a,classes:g})}),nt=()=>{const[i,d]=r.useState([]),[x,a]=r.useState(""),[$,j]=r.useState(""),[y,g]=r.useState(""),[K,b]=r.useState(!1),[Q,D]=r.useState(!1),[X,f]=r.useState("idle"),[A,T]=r.useState(!1),[w,Y]=r.useState(null),[s,C]=r.useState({id:"",name:"",roomNumber:"",localPhone:"",schedules:{Clinic:[],Ultrasound:[]}}),[Z,ee]=r.useState([]),[B,F]=r.useState(0),[h,N]=r.useState(1),[O,te]=r.useState(""),[U,E]=r.useState(!1),[G,P]=r.useState(!1),[oe,se]=r.useState(null),m="/api",_=async()=>{try{const t=await fetch(`${m}/doctor/get-all-doctors?page=${h}&limit=10`);t.ok||(a(t.message),d([]));const o=await t.json();d(o.doctors),F(o.pagination.totalPages)}catch(t){console.log("Error fetching doctors:",t)}},z=async t=>{try{const o=await fetch(`${m}/doctor/get-doctors-by-id/${t}`);if(!o.ok){a(o.message);return}const u=await o.json();C(me=>({...me,...u}))}catch(o){console.log("Error fetching doctor by id:",o),a(o.message)}},ne=async()=>{try{const o=await(await fetch(`${m}/department/get-departments`,{credentials:"include"})).json();ee(o)}catch(t){console.error("Error fetching departments:",t)}},re=async()=>{const t={name:s.name,roomNo:s.roomNumber,localPhone:s.localPhone,departmentId:s.departmentId};try{const o=await fetch(`${m}/doctor/doctor-update-information/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!o.ok){f("error"),D(!0),j(o.message);return}const u=await o.json();T(!1),f("success"),b(!0),g(u.message),_()}catch(o){console.log("Error updating doctor:",o),D(!0),f("error"),j(o.message)}},ae=async()=>{try{const t=await fetch(`${m}/doctor/get-doctors-departments/${O}`);if(t.ok){const o=await t.json();d(o),F(1),a("")}else t.status===404&&a("No doctors found.")}catch(t){console.log("Error Searching for doctor.",t)}};r.useEffect(()=>{_()},[h]),r.useEffect(()=>{w&&(z(w.id),ne())},[w]);const le=t=>{Y(t),T(!0)},H=()=>{T(!1)},S=(t,o)=>{o!=="clickaway"&&(b(!1),D(!1))},ie=()=>{let t=[];for(let o=1;o<=B;o++)t.push(e.jsx(v.Item,{active:o===h,onClick:()=>N(o),children:o},o));return t},ce=t=>{se(t),console.log("selected Id: ",t),E(!0)},J=()=>{E(!1)},de=()=>{E(!1),P(!0)},W=()=>{P(!1)},he=async t=>{console.log("Delete schedule clicked. Id of the doctor to be deleted: ",s?.schedules?.Clinic[t]?.day),console.log("Day to be deleted: ",s?.schedules?.Clinic[t]?.day),console.log("Start time to be deleted: ",s?.schedules?.Clinic[t]?.startTime),console.log("End time to be deleted: ",s?.schedules?.Clinic[t]?.endTime);try{const o=await fetch(`${m}/doctor/delete-doctor-schedule/${s?.schedule_id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctor_department_id:s?.id,day:s?.schedules?.Clinic[t]?.day,startTime:s?.schedules?.Clinic[t]?.startTime,endTime:s?.schedules?.Clinic[t]?.endTime}),credentials:"include"});if(console.log("Response: ",o),o.ok){const u=await o.json();console.log("Data: ",u),f("success"),b(!0),g(u.message),z(s.id),P(!1)}}catch(o){console.log("Error deleting schedule: ",o),f("error"),D(!0),j(o.message)}};return e.jsxs("div",{children:[e.jsxs("div",{id:"doctor-search-bar",children:[e.jsxs("div",{id:"doctor-search-input",children:[e.jsx(pe,{id:"standard-basic",label:"Search for Doctors",variant:"outlined",size:"small",value:O,onChange:t=>te(t.target.value)})," "]}),e.jsx("div",{id:"doctor-search-btn",children:e.jsx(c,{variant:"outline-primary",onClick:()=>ae(),children:"Search"})})]}),X==="success"?e.jsx(V,{open:K,autoHideDuration:5e3,onClose:S,children:e.jsx(q,{onClose:S,severity:"success",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:y})}):e.jsx(V,{open:Q,autoHideDuration:5e3,onClose:S,children:e.jsx(q,{onClose:S,severity:"error",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:$})}),x?e.jsx("p",{style:{color:"red",margin:"1em"},children:x}):e.jsxs("div",{id:"doctors-list",children:[e.jsxs(xe,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"light",className:"my-4 shadow-sm rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Room Number"}),e.jsx("th",{children:"Local Phone"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:i.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.roomNo}),e.jsx("td",{children:t.localPhone}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(c,{variant:"outline-secondary",onClick:()=>le(t),children:"Edit"})})})]},t.id))})]}),e.jsx("div",{id:"pagination",children:e.jsxs(v,{children:[e.jsx(v.Prev,{onClick:()=>N(h-1),disabled:h===1}),ie(),e.jsx(v.Next,{onClick:()=>N(h+1),disabled:h===B})]})})]}),U&&e.jsxs(k,{open:U,onClose:J,children:[e.jsx(I,{children:"Confirm Delete Schedule"}),e.jsx(L,{children:e.jsx(M,{children:'"Please confirm that you wish to proceed with this action. Continuing may modify existing data or records. Review the details carefully before proceeding.'})}),e.jsxs(R,{children:[e.jsx(c,{variant:"outline-secondary",onClick:J,children:"Cancel"}),e.jsx(c,{variant:"outline-danger",onClick:de,children:"Delete"})]})]}),G&&e.jsxs(k,{open:G,onClose:W,children:[e.jsx(I,{children:"Confirm Delete Schedule"}),e.jsx(L,{children:e.jsx(M,{children:"Proceeding will apply the changes permanently and cannot be undone. Do you wish to continue?"})}),e.jsxs(R,{children:[e.jsx(c,{variant:"outline-secondary",onClick:W,children:"Cancel"}),e.jsx(c,{variant:"outline-danger",onClick:()=>he(oe),children:"Delete"})]})]}),A&&e.jsxs(k,{open:A,onClose:H,children:[e.jsx(I,{children:"Doctor's Details"}),e.jsxs(L,{children:[e.jsx(M,{children:"Edit the information of the doctor you want to update. Cancel to close the modal."}),e.jsxs(n,{children:[e.jsxs(p,{children:[e.jsx(l,{children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{className:"fw-bold",children:"Doctor's ID"}),e.jsx(n.Control,{type:"text",placeholder:"Enter Doctor's ID",value:s?s.id:"",readOnly:!0})]})}),e.jsx(l,{children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{className:"fw-bold",children:"Doctor's Name"}),e.jsx(n.Control,{type:"text",placeholder:"Enter Doctor's Name",value:s?s.name:"",onChange:t=>C({...s,name:t.target.value})})]})})]}),e.jsx(p,{children:e.jsx(l,{children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{className:"fw-bold",children:"Doctor's Department"}),e.jsxs(n.Select,{value:s?s.departmentId:"",onChange:t=>C({...s,departmentId:t.target.value}),children:[e.jsx("option",{value:"",children:"Set as Inactive"}),Z.map(t=>e.jsx("option",{value:t.ID,children:t.Name},t.ID))]})]})})}),e.jsxs(p,{children:[e.jsx(l,{children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{className:"fw-bold",children:"Room Number"}),e.jsx(n.Control,{type:"text",placeholder:"Enter Room Number",value:s?s.roomNumber:"",onChange:t=>C({...s,roomNumber:t.target.value})})]})}),e.jsx(l,{children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{className:"fw-bold",children:"Local Phone"}),e.jsx(n.Control,{type:"text",placeholder:"Enter Local Phone",value:s?s.localPhone:"",onChange:t=>C({...s,localPhone:t.target.value})})]})})]}),e.jsx(p,{children:e.jsx(l,{children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{className:"fw-bold",children:"Doctor's Schedules"}),Array.isArray(s.schedules?.Clinic)&&s.schedules.Clinic.map((t,o)=>e.jsxs(n.Group,{className:"me-2",children:[e.jsxs(p,{children:[e.jsx(n.Label,{children:"Available Day: "}),e.jsx(l,{md:12,children:e.jsxs(n.Select,{value:t.day,children:[e.jsx("option",{value:"",children:"Select a day"}),e.jsx("option",{value:"Sun",children:"Sunday"}),e.jsx("option",{value:"Mon",children:"Monday"}),e.jsx("option",{value:"Tue",children:"Tuesday"}),e.jsx("option",{value:"Wed",children:"Wednesday"}),e.jsx("option",{value:"Thur",children:"Thursday"}),e.jsx("option",{value:"Fri",children:"Friday"}),e.jsx("option",{value:"Sat",children:"Saturday"})]})})]}),e.jsxs(p,{children:[e.jsxs(n.Label,{className:"mt-2",children:["Start Time:"," "]}),e.jsx(l,{md:11,children:e.jsx(n.Control,{type:"time",placeholder:"Enter Time",value:t.startTime})}),e.jsx(n.Label,{className:"mt-2",children:"End Time: "}),e.jsx(l,{md:11,children:e.jsx(n.Control,{type:"time",placeholder:"Enter Time",value:t.endTime})}),e.jsx(l,{md:1,className:"mb-3",children:e.jsx(je,{title:"Delete Schedule",children:e.jsx(c,{variant:"outline-danger",onClick:()=>ce(o),children:e.jsx(ue,{})})})})]})]},o))]})})})]})]}),e.jsxs(R,{children:[e.jsx(c,{variant:"outline-secondary",onClick:H,children:"Cancel"}),e.jsx(c,{variant:"outline-success",onClick:()=>re(),children:"Update"})]})]})]})};export{nt as default};
