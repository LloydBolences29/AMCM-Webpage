import{r as i,j as e,u as T,a as R,b as B}from"./index-C3TqbOx3.js";import{u as w,d as I,c as y,a as A,b as z,C as $,G as L}from"./Footer-jYdelOlm.js";import M from"./EKGSpinner-K-28b6B_.js";import{M as P}from"./MainLayout-BccG6Fo3.js";import{C as D}from"./Container-DlJbO_Ix.js";import{F as d}from"./Form-Damoyd4z.js";import{u as F}from"./hook-DfQeCFfU.js";import{A as G}from"./Anchor-Cb53gYmp.js";import{B as H}from"./Button-BPfweHTx.js";/* empty css             */import"./Col-BA0xTIPd.js";import"./extends-CF3RwP-h.js";import"./Button-O3kS6TXu.js";const N=I("h4");N.displayName="DivStyledAsH4";const E=i.forwardRef(({className:t,bsPrefix:o,as:c=N,...n},s)=>(o=w(o,"alert-heading"),e.jsx(c,{ref:s,className:y(t,o),...n})));E.displayName="AlertHeading";const S=i.forwardRef(({className:t,bsPrefix:o,as:c=G,...n},s)=>(o=w(o,"alert-link"),e.jsx(c,{ref:s,className:y(t,o),...n})));S.displayName="AlertLink";const k=i.forwardRef((t,o)=>{const{bsPrefix:c,show:n=!0,closeLabel:s="Close alert",closeVariant:f,className:v,children:p,variant:g="primary",onClose:x,dismissible:b,transition:j=A,...m}=F(t,{show:"onClose"}),u=w(c,"alert"),C=z(a=>{x&&x(!1,a)}),h=j===!0?A:j,r=e.jsxs("div",{role:"alert",...h?void 0:m,ref:o,className:y(v,u,g&&`${u}-${g}`,b&&`${u}-dismissible`),children:[b&&e.jsx($,{onClick:C,"aria-label":s,variant:f}),p]});return h?e.jsx(h,{unmountOnExit:!0,...m,ref:void 0,in:n,children:r}):n?r:null});k.displayName="Alert";const O=Object.assign(k,{Link:S,Heading:E});function U(t){return L({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(t)}function V(t){return L({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(t)}const re=()=>{const[t,o]=i.useState({email:"",password:""}),c="/api",[n,s]=i.useState(""),[f,v]=i.useState(!1),p=T(),{loading:g,setAuth:x}=R(),[b,j]=i.useState(0),[m,u]=i.useState(!1),C=r=>{o({...t,[r.target.name]:r.target.value}),s("")},h=async r=>{if(r.preventDefault(),!r.target[0].value||!r.target[1].value){s("Please fill in all fields."),setTimeout(()=>{s("")},3e3);return}try{const a=await B.post(`${c}/auth/login`,t,{withCredentials:!0}),l=await a.data;if(a.status===200){switch(console.log("Login successful:",l),x({loading:!1,isAuthenticated:!0,user:l.user}),l.user.role){case"admin":p("/admin");break;case"editor":p("/editor");break;default:p("/")}console.log("Role of the user:",l.user.role),o({email:"",password:""})}else s(a.data.error)}catch(a){if(console.error("Login error:",a),a.response?.status===429)s(a.response?.data?.message),u(!0);else if(a.response?.status===401){const l=a.response?.data?.remainingAttempts;console.log("Remaining attempts:",l),s(l!==void 0?`${a.response?.data?.message} (${l+1} attempts left)`:a.response?.data?.error||"Login failed.")}else a.response?.status===403?s(a.response?.data?.error):s("An error occurred during login. Please try again.");setTimeout(()=>s(""),3e3)}};return i.useEffect(()=>{if(m){const r=setTimeout(()=>{u(!1),j(0)},3e4);return()=>clearTimeout(r)}},[m]),e.jsx(P,{children:g?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(M,{})}):e.jsxs(D,{children:[e.jsx("h2",{className:"mt-5",children:"Login"}),e.jsxs(d,{className:"mt-5",onSubmit:h,children:[e.jsxs(d.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e.jsx(d.Label,{children:"Email"}),e.jsx(d.Control,{type:"email",name:"email",placeholder:"Enter your email",value:t.email,onChange:C})]}),e.jsxs(d.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e.jsx(d.Label,{children:"Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(d.Control,{type:f?"text":"password",placeholder:"Password",name:"password",value:t.password,onChange:C}),e.jsx("span",{variant:"link",size:"sm",style:{position:"absolute",right:10,top:"50%",transform:"translateY(-50%)",padding:0},onClick:()=>v(r=>!r),tabIndex:-1,children:f?e.jsx(U,{color:"black"}):e.jsx(V,{color:"black"})})]})]}),n&&e.jsx(O,{variant:"danger",className:"mt-3",children:n}),e.jsx(H,{type:"submit",style:{backgroundColor:"#007682",borderColor:"#007682"},disabled:m,children:"Sign In"})]})]})})};export{re as default};
