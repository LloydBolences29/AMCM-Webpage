import{r as o,j as e}from"./index-CU6FVKgc.js";import{T as F}from"./Table-Eu7fZUmd.js";import{B as m}from"./Button-ECdBtxHj.js";import{S as B,A as k}from"./Alert-DOzaPcP_.js";import{M as l}from"./Footer-Q0PT6RDh.js";import{F as r}from"./Form-BWoNYBnf.js";import{R as g}from"./Row-J6Wi_D9N.js";import{C as i}from"./Col-BOYcffD3.js";import"./Button-Dxk-fcaG.js";import"./ButtonBase-B6JcpL9Z.js";import"./DefaultPropsProvider-BEWS1EG7.js";import"./extends-CF3RwP-h.js";import"./createSimplePaletteValueFilter-CHMUn0vP.js";import"./useSlot-CCE1CtRx.js";import"./getReactElementRef-CFcaMeZi.js";import"./ownerDocument-DW-IO8s5.js";import"./Paper-3KbYhAFn.js";import"./createSvgIcon-CIQck3fE.js";import"./CircularProgress-DA1wQFbY.js";const oe=()=>{const w={username:"",email:"",password:"",role:""},[N,A]=o.useState([]),[b,j]=o.useState(!1),[n,u]=o.useState(w),[P,c]=o.useState("idle"),[R,S]=o.useState(!1),[I,x]=o.useState(!1),[E,d]=o.useState(""),[U,p]=o.useState(!1),[t,f]=o.useState({id:"",username:"",email:"",role:""}),y="/api",M=()=>{j(!0)},T=()=>{j(!1)},L=async s=>{s.preventDefault();try{const a=await fetch(`${y}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"}),h=await a.json();a.ok?(C(),u(w),c("success"),S(!0),d(h.message),j(!1)):(c("error"),d(h.message),x(!0))}catch(a){console.log("Error Adding User.",a),c("error"),x(!0),d(a.message)}},G=async s=>{s.preventDefault();try{const a=await fetch(`${y}/user/edit-user`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"}),h=await a.json();console.log("Data: ",h),a.ok?(C(),c("success"),S(!0),d(h.message),p(!1)):(c("error"),x(!0),d(h.message))}catch(a){console.log("Error Saving User.",a),c("error"),x(!0),d(a.message)}},D=s=>{f(s),p(!0)},C=async()=>{try{const s=await fetch(`${y}/user/get-users`);if(!s.ok)throw new Error("Failed to fetch users");const a=await s.json();A(a)}catch(s){console.error("Error fetching all users:",s)}};o.useEffect(()=>{C()},[]);const v=(s,a)=>{a!=="clickaway"&&(S(!1),x(!1))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"add-user-container",children:e.jsx("div",{id:"add-user-wrapper",children:e.jsx("div",{id:"add-user-button",children:e.jsx(m,{variant:"outline-primary",onClick:M,children:"Add User"})})})}),P==="success"?e.jsx(B,{open:R,autoHideDuration:5e3,onClose:v,children:e.jsx(k,{onClose:v,severity:"success",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:E})}):e.jsx(B,{open:I,autoHideDuration:5e3,onClose:v,children:e.jsx(k,{onClose:v,severity:"error",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:E})}),e.jsxs(F,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"light",className:"my-4 shadow-sm rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:N.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.username}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.role}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(m,{variant:"outline-primary",size:"sm",className:"me-2",onClick:()=>D(s),children:"Edit"})})})]},s.id))})]}),b&&e.jsxs(l,{show:b,onHide:()=>j(!1),children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"Add a User"})}),e.jsx(l.Body,{children:e.jsxs(r,{onSubmit:L,children:[e.jsxs(g,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"Username"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter a username",value:n.username,onChange:s=>{u({...n,username:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Role"}),e.jsxs(r.Control,{as:"select",value:n.role,onChange:s=>u({...n,role:s.target.value}),children:[e.jsx("option",{value:"",children:"Select a Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]})})]}),e.jsxs(g,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicEmail",children:[e.jsx(r.Label,{children:"Email:"}),e.jsx(r.Control,{type:"email",name:"email",placeholder:"Please enter your email",value:n.email,onChange:s=>{u({...n,email:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicPassword",children:[e.jsx(r.Label,{children:"Password:"}),e.jsx(r.Control,{type:"password",placeholder:"Please enter your password",value:n.password,onChange:s=>{u({...n,password:s.target.value})}})]})})]}),e.jsx(m,{className:"mx-1",variant:"secondary",onClick:T,children:"Close"}),e.jsx(m,{className:"mx-1",variant:"primary",type:"submit",children:"Save Changes"})]})})]}),U&&e.jsxs(l,{show:U,onHide:()=>p(!1),children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"Edit User"})}),e.jsx(l.Body,{children:e.jsxs(r,{onSubmit:G,children:[e.jsxs(g,{className:"mb-3",children:[e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"Username"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter a username",value:t?t.username:"",onChange:s=>{f({...t,username:s.target.value})}})]})}),e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Role"}),e.jsxs(r.Control,{as:"select",value:t?t.role:"",onChange:s=>f({...t,role:s.target.value}),children:[e.jsx("option",{value:"",children:"Select a Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]})})]}),e.jsx(g,{className:"mb-3",children:e.jsx(i,{children:e.jsxs(r.Group,{controlId:"formBasicEmail",children:[e.jsx(r.Label,{children:"Email:"}),e.jsx(r.Control,{type:"email",name:"email",placeholder:"Please enter your email",value:t?t.email:"",onChange:s=>{f({...t,email:s.target.value})}})]})})}),e.jsx(m,{className:"mx-1",variant:"secondary",onClick:()=>p(!1),children:"Close"}),e.jsx(m,{className:"mx-1",variant:"primary",type:"submit",children:"Save Changes"})]})})]})]})};export{oe as default};
