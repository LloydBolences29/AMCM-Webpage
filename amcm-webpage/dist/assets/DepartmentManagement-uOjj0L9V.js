import{r as s,j as e}from"./index-36-KKcds.js";import V from"./EKGSpinner-BLnLWFGk.js";import{T as q,P as u}from"./TextField-IxIh5u-q.js";import{S as P,A as B}from"./Alert-r3bE59V6.js";import{B as c}from"./Button-X8vOtK7J.js";import{T as Q}from"./Table-tJuKnK_z.js";import{M as n}from"./Footer-Dx7aH640.js";import{F as i}from"./Form-ITmX9ULE.js";import{R as W}from"./Row-BliNWPvQ.js";import{C as F}from"./Col-BmcAzTUq.js";import"./Anchor-x4p9Dr3f.js";import"./Button-B1G84w8P.js";import"./DefaultPropsProvider-CD6q9gwS.js";import"./extends-CF3RwP-h.js";import"./useSlot-C2xor1-a.js";import"./ButtonBase-D_-r8mrV.js";import"./createSimplePaletteValueFilter-DgdGvFQZ.js";import"./CircularProgress-BBQYZ1eV.js";import"./Select-CJx1qo7E.js";import"./Modal-UXFIvcTM.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./getReactElementRef-BvSF6LhZ.js";import"./Fade-BRuHAOxO.js";import"./debounce-B1ca9UHh.js";import"./useSlotProps-CEFkZG-Q.js";import"./Paper-BP6E42GA.js";import"./createSvgIcon-CpiC1hUo.js";import"./index-DRRKmzcW.js";const ke=()=>{const[I,v]=s.useState([]),[N,x]=s.useState(!1),[o,j]=s.useState(1),[D,C]=s.useState(0),[E,$]=s.useState(""),[w,m]=s.useState(!1),[k,f]=s.useState(!1),[a,T]=s.useState({id:"",name:""}),[A,H]=s.useState(""),[b,g]=s.useState(""),[L,M]=s.useState(""),[z,S]=s.useState(!1),[R,d]=s.useState(!1),[G,l]=s.useState("idle"),h="/api",y=async()=>{try{x(!0);const t=await fetch(`${h}/department/get-all-departments?page=${o}&limit=10`);if(t.ok){const r=await t.json();v(r.departments),C(r.pagination.totalPages)}}catch(t){console.error("Error fetching departments:",t),g("Error Fetching department.")}finally{x(!1)}};s.useEffect(()=>{y()},[o]),s.useEffect(()=>{const t=setTimeout(()=>{x(!1)},5e3);return()=>clearTimeout(t)},[]);const O=()=>{let t=[];for(let r=1;r<=D;r++)t.push(e.jsx(u.Item,{active:r===o,onClick:()=>j(r),children:r},r));return t},U=async()=>{try{const t=await fetch(`${h}/department/search-department/${E}`,{credentials:"include"});if(t.ok){const r=await t.json();v(r.department),C(1),g(""),console.log("Search result:",r.department)}else t.status===404&&g("Department not Found!!")}catch(t){console.error("Error searching department:",t)}},_=t=>{T(t),m(!0)},p=(t,r)=>{r!=="clickaway"&&(S(!1),d(!1))},J=async()=>{try{const t=await fetch(`${h}/department/update-department/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.name}),credentials:"include"});if(t.ok){const r=await t.json();l("success"),S(!0),M(r.message),m(!1),y()}else l("error"),d(!0)}catch(t){console.log("Error Updating your department",t),console.log("Selected Department Name: ",a.name),H(t.message),l("error"),d(!0)}},K=async()=>{try{const t=await fetch(`${h}/department/delete-department/${a.id}`,{method:"DELETE"});if(t.ok){const r=await t.json();l("success"),M(r.message),S(!0),f(!1),y()}else l("error"),d(!0)}catch(t){console.log("Error Deleting the department",t),l("error"),d(!0)}};return e.jsxs("div",{children:[e.jsxs("div",{id:"search-nav",children:[e.jsx("div",{id:"department-search-bar",children:e.jsx(q,{id:"standard-basic",label:"Search for Departments",variant:"outlined",size:"small",value:E,onChange:t=>$(t.target.value)})}),G==="success"?e.jsx(P,{open:z,autoHideDuration:5e3,onClose:p,children:e.jsx(B,{onClose:p,severity:"success",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:L})}):e.jsx(P,{open:R,autoHideDuration:5e3,onClose:p,children:e.jsx(B,{onClose:p,severity:"error",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:A})}),e.jsx("div",{id:"department-search-btn",children:e.jsx(c,{variant:"outline-primary",onClick:()=>U(),children:"Search"})})]}),N?e.jsx(e.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsx(V,{})})}):b?e.jsx("p",{style:{color:"red",margin:"1em"},children:b}):e.jsxs(e.Fragment,{children:[e.jsxs(Q,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"light",className:"my-4 shadow-sm rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:I.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.name}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(c,{variant:"outline-primary",size:"sm",className:"me-2",onClick:()=>_(t),children:"Edit"})})})]},t.id))})]}),e.jsx("div",{children:e.jsxs(u,{children:[e.jsx(u.Prev,{onClick:()=>j(o-1),disabled:o===1}),O(),e.jsx(u.Next,{onClick:()=>j(o+1),disabled:o===D})]})})]}),w&&e.jsxs(n,{show:w,onHide:()=>m(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Edit Department"})}),e.jsx(n.Body,{children:e.jsx(i,{children:e.jsxs(W,{children:[e.jsx(F,{children:e.jsxs(i.Group,{controlId:"formDepartmentName",children:[e.jsx(i.Label,{children:"Department ID"}),e.jsx(i.Control,{type:"text",placeholder:a.id,value:a?a.id:"",readOnly:!0})]})}),e.jsx(F,{children:e.jsxs(i.Group,{controlId:"formDepartmentName",children:[e.jsx(i.Label,{children:"Department Name"}),e.jsx(i.Control,{type:"text",placeholder:a,value:a?a.name:"",onChange:t=>T({...a,name:t.target.value})})]})})]})})}),e.jsxs(n.Footer,{children:[e.jsx(c,{variant:"secondary",onClick:()=>m(!1),children:"Close"}),e.jsx(c,{variant:"primary",onClick:()=>J(),children:"Save Changes"})]})]}),k&&e.jsxs(n,{show:k,onHide:()=>f(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Delete Department"})}),e.jsxs(n.Body,{children:["Are you sure you want to delete the department"," ",e.jsx("strong",{children:a.name}),"?"]}),e.jsxs(n.Footer,{children:[e.jsx(c,{variant:"secondary",onClick:()=>f(!1),children:"Cancel"}),e.jsx(c,{variant:"danger",onClick:()=>K(),children:"Delete"})]})]})]})};export{ke as default};
