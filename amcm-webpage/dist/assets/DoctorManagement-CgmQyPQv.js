import{r as n,j as e}from"./index-DlVAgkeO.js";import{a as ue}from"./Footer-DvhtKQwl.js";import{T as me,P as v}from"./TextField-BZjz8Q-U.js";import{B as i}from"./Button-BwE_hpmx.js";import{S as q,A as K}from"./Alert-BEPAvXT2.js";import{T as pe}from"./Table-BZvAuZJ-.js";import{c as k,D as I,a as L,b as R,T as xe}from"./Tooltip-CLiUYSn5.js";import{g as je,a as ge,u as fe,s as De,c as ye,b as Ce,r as Se}from"./DefaultPropsProvider-B48Vp2qw.js";import{T as ve}from"./Typography-pWighfrS.js";import{F as s}from"./Form-B6uVeF9r.js";import{R as p}from"./Row-BmoNzbsl.js";import{C as l}from"./Col-DbWGna5v.js";import"./Anchor-BIOSxkaL.js";import"./Button-DxlEX406.js";import"./useSlot-CA_X_iIE.js";import"./ButtonBase-YcRQN4Tw.js";import"./extends-CF3RwP-h.js";import"./createSimplePaletteValueFilter-BgsaNsIW.js";import"./CircularProgress-Cg5E58L3.js";import"./Select-fkcMf9F5.js";import"./Modal-Cwgr0RGM.js";import"./ownerWindow-BFkAG_N2.js";import"./ownerDocument-DW-IO8s5.js";import"./getReactElementRef-J8UyCM58.js";import"./Fade-XULd4S9V.js";import"./useSlotProps-BIrE1doK.js";import"./Paper-CWKuupwg.js";import"./debounce-Be36O1Ab.js";import"./createSvgIcon-ciaCS_cv.js";import"./index-sKi7l6K1.js";function be(c){return je("MuiDialogContentText",c)}ge("MuiDialogContentText",["root"]);const we=c=>{const{classes:d}=c,a=Ce({root:["root"]},be,d);return{...d,...a}},Te=De(ve,{shouldForwardProp:c=>Se(c)||c==="classes",name:"MuiDialogContentText",slot:"Root"})({}),M=n.forwardRef(function(d,x){const a=fe({props:d,name:"MuiDialogContentText"}),{children:O,className:j,...y}=a,g=we(y);return e.jsx(Te,{component:"p",variant:"body1",color:"textSecondary",ref:x,ownerState:y,className:ye(g.root,j),...a,classes:g})}),st=()=>{const[c,d]=n.useState([]),[x,a]=n.useState(""),[O,j]=n.useState(""),[y,g]=n.useState(""),[Q,b]=n.useState(!1),[X,C]=n.useState(!1),[Y,f]=n.useState("idle"),[$,w]=n.useState(!1),[T,Z]=n.useState(null),[r,D]=n.useState({id:"",name:"",roomNumber:"",localPhone:"",schedules:{Clinic:[],Ultrasound:[]}}),[ee,te]=n.useState([]),[A,B]=n.useState(0),[h,N]=n.useState(1),[F,oe]=n.useState(""),[U,P]=n.useState(!1),[_,E]=n.useState(!1),[G,se]=n.useState(null),m="/api",z=async()=>{try{const t=await fetch(`${m}/doctor/get-all-doctors?page=${h}&limit=10`);t.ok||(a(t.message),d([]));const o=await t.json();d(o.doctors),B(o.pagination.totalPages)}catch(t){console.log("Error fetching doctors:",t)}},H=async t=>{try{const o=await fetch(`${m}/doctor/get-doctors-with-all-details/${t}`);if(!o.ok){a(o.message);return}const u=await o.json();console.log("Doctor by ID fetch result: ",u),D(u.doctors[0])}catch(o){console.log("Error fetching doctor by id:",o),a(o.message)}},re=async()=>{try{const o=await(await fetch(`${m}/department/get-departments`,{credentials:"include"})).json();te(o)}catch(t){console.error("Error fetching departments:",t)}},ne=async()=>{const t={name:r.name,roomNo:r.roomNumber,localPhone:r.localPhone,departmentId:r.departmentId};try{const o=await fetch(`${m}/doctor/doctor-update-information/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!o.ok){f("error"),C(!0),j(o.message);return}const u=await o.json();w(!1),f("success"),b(!0),g(u.message),z()}catch(o){console.log("Error updating doctor:",o),C(!0),f("error"),j(o.message)}},ae=async()=>{try{const t=await fetch(`${m}/doctor/get-doctors-departments/${F}`);if(t.ok){const o=await t.json();d(o),B(1),a("")}else t.status===404&&a("No doctors found.")}catch(t){console.log("Error Searching for doctor.",t)}};n.useEffect(()=>{z()},[h]),n.useEffect(()=>{T&&(H(T.id),re())},[T]);const le=t=>{Z(t),w(!0)},W=()=>{w(!1)},S=(t,o)=>{o!=="clickaway"&&(b(!1),C(!1))},ce=()=>{let t=[];for(let o=1;o<=A;o++)t.push(e.jsx(v.Item,{active:o===h,onClick:()=>N(o),children:o},o));return t},ie=t=>{se(t),console.log("selected Id: ",t),P(!0)},J=()=>{P(!1)},de=()=>{P(!1),E(!0)},V=()=>{E(!1)},he=async t=>{console.log("Doctor by ID ",r);try{const o=await fetch(`${m}/doctor/delete-doctor-schedule/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"});if(console.log("Response: ",o),o.ok){const u=await o.json();console.log("Data: ",u),f("success"),b(!0),g(u.message),H(r.id),E(!1)}}catch(o){console.log("Error deleting schedule: ",o),f("error"),C(!0),j(o.message)}};return console.log("Doctors: ",G),e.jsxs("div",{children:[e.jsxs("div",{id:"doctor-search-bar",children:[e.jsxs("div",{id:"doctor-search-input",children:[e.jsx(me,{id:"standard-basic",label:"Search for Doctors",variant:"outlined",size:"small",value:F,onChange:t=>oe(t.target.value)})," "]}),e.jsx("div",{id:"doctor-search-btn",children:e.jsx(i,{variant:"outline-primary",onClick:()=>ae(),children:"Search"})})]}),Y==="success"?e.jsx(q,{open:Q,autoHideDuration:5e3,onClose:S,children:e.jsx(K,{onClose:S,severity:"success",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:y})}):e.jsx(q,{open:X,autoHideDuration:5e3,onClose:S,children:e.jsx(K,{onClose:S,severity:"error",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:O})}),x?e.jsx("p",{style:{color:"red",margin:"1em"},children:x}):e.jsxs("div",{id:"doctors-list",children:[e.jsxs(pe,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"light",className:"my-4 shadow-sm rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Room Number"}),e.jsx("th",{children:"Local Phone"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:c.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.roomNo}),e.jsx("td",{children:t.localPhone}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(i,{variant:"outline-secondary",onClick:()=>le(t),children:"Edit"})})})]},t.id))})]}),e.jsx("div",{id:"pagination",children:e.jsxs(v,{children:[e.jsx(v.Prev,{onClick:()=>N(h-1),disabled:h===1}),ce(),e.jsx(v.Next,{onClick:()=>N(h+1),disabled:h===A})]})})]}),U&&e.jsxs(k,{open:U,onClose:J,children:[e.jsx(I,{children:"Confirm Delete Schedule"}),e.jsx(L,{children:e.jsx(M,{children:'"Please confirm that you wish to proceed with this action. Continuing may modify existing data or records. Review the details carefully before proceeding.'})}),e.jsxs(R,{children:[e.jsx(i,{variant:"outline-secondary",onClick:J,children:"Cancel"}),e.jsx(i,{variant:"outline-danger",onClick:de,children:"Delete"})]})]}),_&&e.jsxs(k,{open:_,onClose:V,children:[e.jsx(I,{children:"Confirm Delete Schedule"}),e.jsx(L,{children:e.jsx(M,{children:"Proceeding will apply the changes permanently and cannot be undone. Do you wish to continue?"})}),e.jsxs(R,{children:[e.jsx(i,{variant:"outline-secondary",onClick:V,children:"Cancel"}),e.jsx(i,{variant:"outline-danger",onClick:()=>he(G),children:"Delete"})]})]}),$&&e.jsxs(k,{open:$,onClose:W,children:[e.jsx(I,{children:"Doctor's Details"}),e.jsxs(L,{children:[e.jsx(M,{children:"Edit the information of the doctor you want to update. Cancel to close the modal."}),e.jsxs(s,{children:[e.jsxs(p,{children:[e.jsx(l,{children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-bold",children:"Doctor's ID"}),e.jsx(s.Control,{type:"text",placeholder:"Enter Doctor's ID",value:r?r.id:"",readOnly:!0})]})}),e.jsx(l,{children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-bold",children:"Doctor's Name"}),e.jsx(s.Control,{type:"text",placeholder:"Enter Doctor's Name",value:r?r.name:"",onChange:t=>D({...r,name:t.target.value})})]})})]}),e.jsx(p,{children:e.jsx(l,{children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-bold",children:"Doctor's Department"}),e.jsxs(s.Select,{value:r?r.departmentId:"",onChange:t=>D({...r,departmentId:t.target.value}),children:[e.jsx("option",{value:"",children:"Set as Inactive"}),ee.map(t=>e.jsx("option",{value:t.ID,children:t.Name},t.ID))]})]})})}),e.jsxs(p,{children:[e.jsx(l,{children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-bold",children:"Room Number"}),e.jsx(s.Control,{type:"text",placeholder:"Enter Room Number",value:r?r.roomNumber:"",onChange:t=>D({...r,roomNumber:t.target.value})})]})}),e.jsx(l,{children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-bold",children:"Local Phone"}),e.jsx(s.Control,{type:"text",placeholder:"Enter Local Phone",value:r?r.localPhone:"",onChange:t=>D({...r,localPhone:t.target.value})})]})})]}),e.jsx(p,{children:e.jsx(l,{children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-bold",children:"Doctor's Schedules"}),Array.isArray(r.schedules?.clinic)&&r.schedules?.clinic.map((t,o)=>e.jsxs(s.Group,{className:"me-2",children:[e.jsxs(p,{children:[e.jsx(s.Label,{children:"Available Day: "}),e.jsx(l,{md:12,children:e.jsxs(s.Select,{value:t.day_of_the_week,children:[e.jsx("option",{value:"",children:"Select a day"}),e.jsx("option",{value:"Sun",children:"Sunday"}),e.jsx("option",{value:"Mon",children:"Monday"}),e.jsx("option",{value:"Tue",children:"Tuesday"}),e.jsx("option",{value:"Wed",children:"Wednesday"}),e.jsx("option",{value:"Thur",children:"Thursday"}),e.jsx("option",{value:"Fri",children:"Friday"}),e.jsx("option",{value:"Sat",children:"Saturday"})]})})]}),e.jsxs(p,{children:[e.jsxs(s.Label,{className:"mt-2",children:["Start Time:"," "]}),e.jsx(l,{md:11,children:e.jsx(s.Control,{type:"time",placeholder:"Enter Time",value:t.start_time,readOnly:!0})}),e.jsx(s.Label,{className:"mt-2",children:"End Time: "}),e.jsx(l,{md:11,children:e.jsx(s.Control,{type:"time",placeholder:"Enter Time",value:t.end_time,readOnly:!0})}),e.jsx(l,{md:1,className:"mb-3",children:e.jsx(xe,{title:"Delete Schedule",children:e.jsx(i,{variant:"outline-danger",onClick:()=>ie(r.schedules.clinic[o].schedule_id),children:e.jsx(ue,{})})})})]})]},o))]})})})]})]}),e.jsxs(R,{children:[e.jsx(i,{variant:"outline-secondary",onClick:W,children:"Cancel"}),e.jsx(i,{variant:"outline-success",onClick:()=>ne(),children:"Update"})]})]})]})};export{st as default};
