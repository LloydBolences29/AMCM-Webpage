import{r as i,j as e}from"./index-36-KKcds.js";import{T as H}from"./Table-tJuKnK_z.js";import{B as j}from"./Button-X8vOtK7J.js";import{S as k,A as I}from"./Alert-r3bE59V6.js";import{M as d}from"./Footer-Dx7aH640.js";import{F as r}from"./Form-ITmX9ULE.js";import{R as m}from"./Row-BliNWPvQ.js";import{C as o}from"./Col-BmcAzTUq.js";import"./Button-B1G84w8P.js";import"./ButtonBase-D_-r8mrV.js";import"./DefaultPropsProvider-CD6q9gwS.js";import"./extends-CF3RwP-h.js";import"./createSimplePaletteValueFilter-DgdGvFQZ.js";import"./useSlot-C2xor1-a.js";import"./getReactElementRef-BvSF6LhZ.js";import"./ownerDocument-DW-IO8s5.js";import"./Paper-BP6E42GA.js";import"./createSvgIcon-CpiC1hUo.js";import"./CircularProgress-BBQYZ1eV.js";const ie=()=>{const w={firstname:"",lastname:"",username:"",email:"",password:"",role:""},[L,N]=i.useState([]),[B,v]=i.useState(!1),[l,h]=i.useState(w),[A,u]=i.useState("idle"),[P,C]=i.useState(!1),[G,p]=i.useState(!1),[U,x]=i.useState(""),[E,f]=i.useState(!1),[a,c]=i.useState({id:"",firstname:"",lastname:"",username:"",email:"",role:""}),[R,F]=i.useState(null),S="/api",M=()=>{v(!0)},O=()=>{v(!1)},T=async s=>{s.preventDefault();try{const t=await fetch(`${S}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),credentials:"include"}),n=await t.json();t.ok?(y(),h(w),u("success"),C(!0),x(n.message),v(!1)):(u("error"),x(n.message),p(!0))}catch(t){console.log("Error Adding User.",t),u("error"),p(!0),x(t.message)}},_=async s=>{s.preventDefault();const t={};if(Object.keys(a).forEach(n=>{a[n]!==R[n]&&(t[n]=a[n])}),t.id=a.id,Object.keys(t).length<=1){console.log("No changes detected.");return}try{const n=await fetch(`${S}/user/edit-user`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"}),b=await n.json();console.log("Data: ",b),n.ok?(y(),u("success"),C(!0),x(b.message),f(!1)):(u("error"),p(!0),x(b.message))}catch(n){console.log("Error Saving User.",n),u("error"),p(!0),x(n.message)}},D=s=>{c(s),F(s),f(!0)},y=async()=>{try{const s=await fetch(`${S}/user/get-users`);if(!s.ok)throw new Error("Failed to fetch users");const t=await s.json();N(t)}catch(s){console.error("Error fetching all users:",s)}};i.useEffect(()=>{y()},[]);const g=(s,t)=>{t!=="clickaway"&&(C(!1),p(!1))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"add-user-container",children:e.jsx("div",{id:"add-user-wrapper",children:e.jsx("div",{id:"add-user-button",children:e.jsx(j,{variant:"outline-primary",onClick:M,children:"Add User"})})})}),A==="success"?e.jsx(k,{open:P,autoHideDuration:5e3,onClose:g,children:e.jsx(I,{onClose:g,severity:"success",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:U})}):e.jsx(k,{open:G,autoHideDuration:5e3,onClose:g,children:e.jsx(I,{onClose:g,severity:"error",variant:"filled",sx:{width:"100%",margin:"1em",fontSize:"1em"},children:U})}),e.jsxs(H,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"light",className:"my-4 shadow-sm rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:L.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.username}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.role}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(j,{variant:"outline-primary",size:"sm",className:"me-2",onClick:()=>D(s),children:"Edit"})})})]},s.id))})]}),B&&e.jsxs(d,{show:B,onHide:()=>v(!1),children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Add a User"})}),e.jsx(d.Body,{children:e.jsxs(r,{onSubmit:T,children:[e.jsxs(m,{className:"mb-3",children:[e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"First name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter firstname",value:l.firstname,onChange:s=>{h({...l,firstname:s.target.value})}})]})}),e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Last name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter lastname",value:l.lastname,onChange:s=>{h({...l,lastname:s.target.value})}})]})})]}),e.jsxs(m,{className:"mb-3",children:[e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"Username"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter a username",value:l.username,onChange:s=>{h({...l,username:s.target.value})}})]})}),e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Role"}),e.jsxs(r.Control,{as:"select",value:l.role,onChange:s=>h({...l,role:s.target.value}),children:[e.jsx("option",{value:"",children:"Select a Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]})})]}),e.jsxs(m,{className:"mb-3",children:[e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicEmail",children:[e.jsx(r.Label,{children:"Email:"}),e.jsx(r.Control,{type:"email",name:"email",placeholder:"Please enter your email",value:l.email,onChange:s=>{h({...l,email:s.target.value})}})]})}),e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicPassword",children:[e.jsx(r.Label,{children:"Password:"}),e.jsx(r.Control,{type:"password",placeholder:"Please enter your password",value:l.password,onChange:s=>{h({...l,password:s.target.value})}})]})})]}),e.jsx(j,{className:"mx-1",variant:"secondary",onClick:O,children:"Close"}),e.jsx(j,{className:"mx-1",variant:"primary",type:"submit",children:"Save Changes"})]})})]}),E&&e.jsxs(d,{show:E,onHide:()=>f(!1),children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Edit User"})}),e.jsx(d.Body,{children:e.jsxs(r,{onSubmit:_,children:[e.jsxs(m,{className:"mb-3",children:[e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"First name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter firstname",value:a?a.firstname:"",onChange:s=>{c({...a,firstname:s.target.value})}})]})}),e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Last name"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter last name",value:a?a.lastname:"",onChange:s=>{c({...a,lastname:s.target.value})}})]})})]}),e.jsxs(m,{className:"mb-3",children:[e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicUsername",children:[e.jsx(r.Label,{children:"Username"}),e.jsx(r.Control,{type:"text",placeholder:"Please enter a username",value:a?a.username:"",onChange:s=>{c({...a,username:s.target.value})}})]})}),e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicRole",children:[e.jsx(r.Label,{children:"Role"}),e.jsxs(r.Control,{as:"select",value:a?a.role:"",onChange:s=>c({...a,role:s.target.value}),children:[e.jsx("option",{value:"",children:"Select a Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]})})]}),e.jsx(m,{className:"mb-3",children:e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicEmail",children:[e.jsx(r.Label,{children:"Email:"}),e.jsx(r.Control,{type:"email",name:"email",placeholder:"Please enter your email",value:a?a.email:"",onChange:s=>{c({...a,email:s.target.value})}})]})})}),e.jsxs(m,{className:"mb-3",children:[e.jsx(o,{children:e.jsxs(r.Group,{controlId:"formBasicIsActive",children:[e.jsx(r.Label,{children:"Active Status:"}),e.jsxs(r.Control,{as:"select",value:a&&a.is_active!==void 0?a.is_active:"",onChange:s=>{c({...a,is_active:s.target.value})},children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),e.jsx(o,{children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Lock Status:"}),e.jsx(r.Check,{type:"switch",id:"custom-switch",checked:a?a.is_locked:!1,onChange:s=>{c({...a,is_locked:s.target.checked})}})]})})]}),e.jsx(j,{className:"mx-1",variant:"secondary",onClick:()=>f(!1),children:"Close"}),e.jsx(j,{className:"mx-1",variant:"primary",type:"submit",children:"Save Changes"})]})})]})]})};export{ie as default};
